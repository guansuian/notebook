# 1.检索

后端接收到用户输入的 `username` 和 `rawPassword`（明文密码）。首先根据 `username` 去数据库查询，拿到该用户完整的 **Encoded Password**（包含版本、代价因子、盐和哈希值的那个长字符串）。

# 2.提取

系统调用 `passwordEncoder.matches()` 方法。该方法内部会根据 BCrypt 协议的固定偏移量，直接从 Encoded Password 字符串中**截取**出当初注册时生成的随机盐。

# 3.重算

系统将“用户本次输入的明文 `rawPassword`”和“刚刚提取出来的盐”结合，并参考字符串中记录的“代价因子（迭代次数）”，重新执行一遍哈希运算

# 4.对比

将**本次重算的结果**与**数据库中存储的结果**进行全量比对

# 5.反馈

- **一致：** 生成 JWT 或 Session，发放通行证。
    
- **不一致：** 记录一次失败日志，返回错误。
